{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE RecordWildCards #-}

module Data.PunycodeSpec (spec) where

import           Data.ByteString (ByteString)
import           Data.Text (Text)
import           Test.Hspec (Spec, context, parallel, shouldBe)
import           Test.Hspec.QuickCheck (prop)
import           Test.QuickCheck (Arbitrary(..), elements)

import           Data.Punycode (decodePunycode, encodePunycode)

spec :: Spec
spec = parallel $ do

  context "encodePunycode" $

    prop "Should encode Unicode to Punycode" $ \UnicodePunycode{..} ->
      encodePunycode _upUnicode `shouldBe` _upPunycode

  context "decodePunycode" $

      prop "Should decode Punycode to Unicode" $ \UnicodePunycode{..} ->
        decodePunycode _upPunycode `shouldBe` Right _upUnicode

data UnicodePunycode = UnicodePunycode
  { _upUnicode  :: Text
  , _upPunycode :: ByteString }
  deriving (Eq, Show)

instance Arbitrary UnicodePunycode where
  arbitrary = uncurry UnicodePunycode <$> elements
    [ ("ğŸ‘ªğŸ‡¬ğŸ‡§", "f77hja72q")
    , ("ğŸ’©", "ls8h")
    , ("letsğŸ‰", "lets-tp53c")
    , ("à¤•à¥‰à¤®", "11b4c3d")
    , ("ã‚»ãƒ¼ãƒ«", "1ck2e1b")
    , ("ä½›å±±", "1qqw23a")
    , ("à²­à²¾à²°à²¤", "2scrj9c")
    , ("æ…ˆå–„", "30rr7y")
    , ("é›†å›¢", "3bst00m")
    , ("åœ¨çº¿", "3ds443g")
    , ("í•œêµ­", "3e0b707e")
    , ("à¬­à¬¾à¬°à¬¤", "3hcrj9c")
    , ("å¤§ä¼—æ±½è½¦", "3oq18vl8pn36a")
    , ("ç‚¹çœ‹", "3pxu8k")
    , ("à¸„à¸­à¸¡", "42c2d9a")
    , ("à¦­à¦¾à§°à¦¤", "45br5cyl")
    , ("à¦­à¦¾à¦°à¦¤", "45brj9c")
    , ("å…«å¦", "45q11c")
    , ("Ù…ÙˆÙ‚Ø¹", "4gbrim")
    , ("à¦¬à¦¾à¦‚à¦²à¦¾", "54b7fta0cc")
    , ("å…¬ç›Š", "55qw42g")
    , ("å…¬å¸", "55qx5d")
    , ("é¦™æ ¼é‡Œæ‹‰", "5su34j936bgsg")
    , ("ç½‘ç«™", "5tzm5g")
    , ("ç§»åŠ¨", "6frz82g")
    , ("æˆ‘çˆ±ä½ ", "6qq986b3xl")
    , ("Ğ¼Ğ¾ÑĞºĞ²Ğ°", "80adxhks")
    , ("Ò›Ğ°Ğ·", "80ao21a")
    , ("ĞºĞ°Ñ‚Ğ¾Ğ»Ğ¸Ğº", "80aqecdr1a")
    , ("Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½", "80asehdb")
    , ("ÑĞ°Ğ¹Ñ‚", "80aswg")
    , ("è”é€š", "8y0a063a")
    , ("ÑÑ€Ğ±", "90a3ac")
    , ("Ğ±Ğ³", "90ae")
    , ("Ğ±ĞµĞ»", "90ais")
    , ("×§×•×", "9dbq2a")
    , ("æ—¶å°š", "9et52u")
    , ("å¾®åš", "9krt00a")
    , ("æ·¡é©¬é”¡", "b4w605ferd")
    , ("ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³", "bck1b9a5dre4c")
    , ("Ğ¾Ñ€Ğ³", "c1avg")
    , ("à¤¨à¥‡à¤Ÿ", "c2br7g")
    , ("ã‚¹ãƒˆã‚¢", "cck2b3b")
    , ("ì‚¼ì„±", "cg4bki")
    , ("à®šà®¿à®™à¯à®•à®ªà¯à®ªà¯‚à®°à¯", "clchc0ea0b2g2a9gcd")
    , ("å•†æ ‡", "czr694b")
    , ("å•†åº—", "czrs0t")
    , ("å•†åŸ", "czru2d")
    , ("Ğ´ĞµÑ‚Ğ¸", "d1acj3b")
    , ("Ğ¼ĞºĞ´", "d1alf")
    , ("ĞµÑ", "e1a4c")
    , ("ãƒã‚¤ãƒ³ãƒˆ", "eckvdtc9d")
    , ("æ–°é—»", "efvy88h")
    , ("å·¥è¡Œ", "estv75g")
    , ("å®¶é›»", "fct429k")
    , ("ÙƒÙˆÙ…", "fhbei")
    , ("ä¸­æ–‡ç½‘", "fiq228c5hs")
    , ("ä¸­ä¿¡", "fiq64b")
    , ("ä¸­å›½", "fiqs8s")
    , ("ä¸­åœ‹", "fiqz9s")
    , ("å¨±ä¹", "fjq720a")
    , ("è°·æ­Œ", "flw351e")
    , ("à°­à°¾à°°à°¤à±", "fpcrj9c3d")
    , ("à¶½à¶‚à¶šà·", "fzc2c9e2c")
    , ("é›»è¨Šç›ˆç§‘", "fzys8d69uvgm")
    , ("è´­ç‰©", "g2xx48c")
    , ("ã‚¯ãƒ©ã‚¦ãƒ‰", "gckr3f0f")
    , ("àª­àª¾àª°àª¤", "gecrj9c")
    , ("é€šè²©", "gk3at1e")
    , ("à¤­à¤¾à¤°à¤¤à¤®à¥", "h2breg3eve")
    , ("à¤­à¤¾à¤°à¤¤", "h2brj9c")
    , ("à¤­à¤¾à¤°à¥‹à¤¤", "h2brj9c8c")
    , ("ç½‘åº—", "hxt814e")
    , ("à¤¸à¤‚à¤—à¤ à¤¨", "i1b6b1a6a2e")
    , ("é¤å…", "imr513n")
    , ("ç½‘ç»œ", "io0a7i")
    , ("ĞºĞ¾Ğ¼", "j1aef")
    , ("ÑƒĞºÑ€", "j1amh")
    , ("é¦™æ¸¯", "j6w193g")
    , ("è¯ºåŸºäºš", "jlq61u9w7b")
    , ("é£Ÿå“", "jvr189m")
    , ("é£åˆ©æµ¦", "kcrx77d1x4a")
    , ("å°æ¹¾", "kprw13d")
    , ("å°ç£", "kpry57d")
    , ("æ‰‹è¡¨", "kpu716f")
    , ("æ‰‹æœº", "kput3i")
    , ("Ğ¼Ğ¾Ğ½", "l1acc")
    , ("Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "lgbbat1ad8j")
    , ("Ø¹Ù…Ø§Ù†", "mgb9awbf")
    , ("Ø§Ø±Ø§Ù…ÙƒÙˆ", "mgba3a3ejt")
    , ("Ø§ÛŒØ±Ø§Ù†", "mgba3a4f16a")
    , ("Ø§Ù„Ø¹Ù„ÙŠØ§Ù†", "mgba7c0bbn0a")
    , ("Ø§ØªØµØ§Ù„Ø§Øª", "mgbaakc7dvf")
    , ("Ø§Ù…Ø§Ø±Ø§Øª", "mgbaam7a8h")
    , ("Ø¨Ø§Ø²Ø§Ø±", "mgbab2bd")
    , ("Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§", "mgbah1a3hjkrd")
    , ("Ù¾Ø§Ú©Ø³ØªØ§Ù†", "mgbai9azgqp6j")
    , ("Ø§Ù„Ø§Ø±Ø¯Ù†", "mgbayh7gpa")
    , ("Ù…ÙˆØ¨Ø§ÙŠÙ„ÙŠ", "mgbb9fbpob")
    , ("Ø¨Ø§Ø±Øª", "mgbbh1a")
    , ("Ø¨Ú¾Ø§Ø±Øª", "mgbbh1a71e")
    , ("Ø§Ù„Ù…ØºØ±Ø¨", "mgbc0a9azcg")
    , ("Ø§Ø¨ÙˆØ¸Ø¨ÙŠ", "mgbca7dzdo")
    , ("Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©", "mgberp4a5d4ar")
    , ("Ú€Ø§Ø±Øª", "mgbgu82a")
    , ("ÙƒØ§Ø«ÙˆÙ„ÙŠÙƒ", "mgbi4ecexp")
    , ("Ø³ÙˆØ¯Ø§Ù†", "mgbpl2fh")
    , ("Ù‡Ù…Ø±Ø§Ù‡", "mgbt3dhd")
    , ("Ø¹Ø±Ø§Ù‚", "mgbtx2b")
    , ("Ù…Ù„ÙŠØ³ÙŠØ§", "mgbx4cd0ab")
    , ("æ¾³é–€", "mix891f")
    , ("ë‹·ì»´", "mk1bu44c")
    , ("æ”¿åºœ", "mxtq1m")
    , ("Ø´Ø¨ÙƒØ©", "ngbc5azd")
    , ("Ø¨ÙŠØªÙƒ", "ngbe9e0a")
    , ("Ø¹Ø±Ø¨", "ngbrx")
    , ("áƒ’áƒ”", "node")
    , ("æœºæ„", "nqv7f")
    , ("ç»„ç»‡æœºæ„", "nqv7fs00ema")
    , ("å¥åº·", "nyqy26a")
    , ("à¹„à¸—à¸¢", "o3cw4h")
    , ("Ø³ÙˆØ±ÙŠØ©", "ogbpf8fl")
    , ("æ‹›è˜", "otu796d")
    , ("Ñ€ÑƒÑ", "p1acf")
    , ("Ñ€Ñ„", "p1ai")
    , ("ç å®", "pbt977c")
    , ("ØªÙˆÙ†Ø³", "pgbs0dh")
    , ("å¤§æ‹¿", "pssy2u")
    , ("ã¿ã‚“ãª", "q9jyb4c")
    , ("ã‚°ãƒ¼ã‚°ãƒ«", "qcka1pmc")
    , ("ÎµÎ»", "qxam")
    , ("ä¸–ç•Œ", "rhqv96g")
    , ("æ›¸ç±", "rovu88b")
    , ("à´­à´¾à´°à´¤à´‚", "rvc1e0am3e")
    , ("à¨­à¨¾à¨°à¨¤", "s9brj9c")
    , ("ç½‘å€", "ses554g")
    , ("ë‹·ë„·", "t60b56a")
    , ("ã‚³ãƒ ", "tckwe")
    , ("å¤©ä¸»æ•™", "tiq49xqyj")
    , ("æ¸¸æˆ", "unup4y")
    , ("vermÃ¶gensberater", "vermgensberater-ctb")
    , ("vermÃ¶gensberatung", "vermgensberatung-pwb")
    , ("ä¼ä¸š", "vhquv")
    , ("ä¿¡æ¯", "vuq861b")
    , ("å˜‰é‡Œå¤§é…’åº—", "w4r85el8fhu5dnra")
    , ("å˜‰é‡Œ", "w4rs40l")
    , ("Ù…ØµØ±", "wgbh1c")
    , ("Ù‚Ø·Ø±", "wgbl6a")
    , ("å¹¿ä¸œ", "xhq521b")
    , ("à®‡à®²à®™à¯à®•à¯ˆ", "xkc2al3hye2a")
    , ("à®‡à®¨à¯à®¤à®¿à®¯à®¾", "xkc2dl3a5ee0h")
    , ("Õ°Õ¡Õµ", "y9a3aq")
    , ("æ–°åŠ å¡", "yfro4i67o")
    , ("ÙÙ„Ø³Ø·ÙŠÙ†", "ygbi2ammx")
    , ("æ”¿åŠ¡", "zfr164b")
    ]
